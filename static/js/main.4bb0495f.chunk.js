(this["webpackJsonpcars-react"]=this["webpackJsonpcars-react"]||[]).push([[0],{193:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),s=r(75),c=r.n(s),i=(r(87),r(88),r(3)),l=r(7),o=r.n(l),j=r(12),u=r(2),d=r(5),h=r(0),b=a.a.createContext();var p=function(e){var t=e.children,r=a.a.useState({authToken:null,userId:null,email:null}),n=Object(d.a)(r,2),s=n[0],c=n[1];return Object(h.jsx)(b.Provider,{value:{user:s,setUser:c},children:t})};var m=function(){var e=a.a.useContext(b),t=e.setUser,r=e.user,n=Object(i.f)(),s=function(){var e=Object(j.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({authToken:null,userId:null,username:null}),n.push("/");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)("header",{children:Object(h.jsxs)("nav",{children:[Object(h.jsx)(u.b,{className:"active",to:"/",children:"Home"}),Object(h.jsx)(u.b,{to:"/all-listings",children:"All Listings"}),Object(h.jsx)(u.b,{to:"/by-year",children:"By Year"}),r.authToken?Object(h.jsxs)("div",{id:"profile",children:[Object(h.jsxs)("a",{children:["Welcome ",null===r||void 0===r?void 0:r.email]}),Object(h.jsx)(u.b,{to:"/my-listings",children:"My Listings"}),Object(h.jsx)(u.b,{to:"/create-car",children:"Create Listing"}),Object(h.jsx)(u.b,{onClick:s,to:"/",children:"Logout"})]}):Object(h.jsxs)("div",{id:"guest",children:[Object(h.jsx)(u.b,{to:"/login",children:"Login"}),Object(h.jsx)(u.b,{to:"/register",children:"Register"})]})]})})};var x=function(){return Object(h.jsx)("section",{id:"main",children:Object(h.jsxs)("div",{id:"welcome-container",children:[Object(h.jsx)("h1",{children:"Welcome To Car Tube"}),Object(h.jsx)("img",{className:"hero",src:"/images/car-png.webp",alt:"carIntro"}),Object(h.jsx)("h2",{children:"To see all the listings click the link below:"}),Object(h.jsx)("div",{children:Object(h.jsx)(u.b,{to:"/all-listings",className:"button",children:"Listings"})})]})})};var O=function(e){var t=e.history,r=a.a.useContext(b).setUser,n=function(){var e=Object(j.a)(o.a.mark((function e(n){var a,s,c,i,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),a=n.target,s=a.email,c=a.password,e.prev=2,e.next=5,fetch("https://cars-react-app-server.herokuapp.com/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s.value,password:c.value})});case 5:if((i=e.sent).ok){e.next=12;break}return e.t0=Error,e.next=10,i.json();case 10:throw e.t1=e.sent.message,new e.t0(e.t1);case 12:return e.next=14,i.json();case 14:l=e.sent,r({authToken:l.accessToken,userId:l._id,email:l.email}),t.push("/"),e.next=22;break;case 19:e.prev=19,e.t2=e.catch(2),alert(e.t2.message);case 22:case"end":return e.stop()}}),e,null,[[2,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)("section",{id:"login",children:Object(h.jsxs)("div",{className:"container",children:[Object(h.jsxs)("form",{onSubmit:n,id:"login-form",children:[Object(h.jsx)("h1",{children:"Login"}),Object(h.jsx)("p",{children:"Please enter your credentials."}),Object(h.jsx)("hr",{}),Object(h.jsx)("p",{children:"Email"}),Object(h.jsx)("input",{placeholder:"Enter Email",name:"email",type:"text"}),Object(h.jsx)("p",{children:"Password"}),Object(h.jsx)("input",{type:"password",placeholder:"Enter Password",name:"password"}),Object(h.jsx)("input",{type:"submit",className:"registerbtn",value:"Login"})]}),Object(h.jsx)("div",{className:"signin",children:Object(h.jsxs)("p",{children:["Dont have an account?",Object(h.jsx)(u.b,{to:"/register",children:"Sign up"}),"."]})})]})})},f=r(82),v=r(23);var g=function(e){var t=e.history,r=Object(f.a)({initialValues:{email:"",password:"",repeatPass:""},validationSchema:v.a({email:v.c().email("Invalid email! Example: email@gmail.com"),password:v.c().min(6,"Password must be at least 6 charcakters!").matches(/\w+/,"Password must match any letter, digit or underscore"),repeatPass:v.c().oneOf([v.b("password"),null],"Passwords must match!")}),onSubmit:function(){var e=Object(j.a)(o.a.mark((function e(r){var n,a,s,c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.email,a=r.password,s=r.repeatPass,e.prev=1,a===s){e.next=4;break}throw new Error("Passwords don't match!");case 4:return e.next=6,fetch("https://cars-react-app-server.herokuapp.com/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:a})});case 6:if((c=e.sent).ok){e.next=13;break}return e.t0=Error,e.next=11,c.json();case 11:throw e.t1=e.sent.message,new e.t0(e.t1);case 13:return e.next=15,c.json();case 15:i=e.sent,p({authToken:i.accessToken,userId:i._id,email:i.email}),t.push("/all-listings"),e.next=23;break;case 20:return e.prev=20,e.t2=e.catch(1),e.abrupt("return",alert(e.t2.message));case 23:case"end":return e.stop()}}),e,null,[[1,20]])})));return function(t){return e.apply(this,arguments)}}()}),n=r.handleSubmit,s=r.handleChange,c=r.values,i=r.touched,l=r.errors,d=r.handleBlur,p=a.a.useContext(b).setUser;return Object(h.jsx)("section",{id:"register",children:Object(h.jsxs)("div",{className:"container",children:[Object(h.jsxs)("form",{onSubmit:n,id:"register-form",children:[Object(h.jsx)("h1",{children:"Register"}),Object(h.jsx)("p",{children:"Please fill in this form to create an account."}),Object(h.jsx)("hr",{}),Object(h.jsx)("p",{children:"Email"}),Object(h.jsx)("input",{value:c.email,onChange:s,onBlur:d,type:"text",placeholder:"Enter Email",name:"email",required:!0}),i.email&&l.email?Object(h.jsx)("div",{children:l.email}):null,Object(h.jsx)("p",{children:"Password"}),Object(h.jsx)("input",{value:c.password,onChange:s,onBlur:d,type:"password",placeholder:"Enter Password",name:"password",required:!0}),i.password&&l.password?Object(h.jsx)("div",{children:l.password}):null,Object(h.jsx)("p",{children:"Repeat Password"}),Object(h.jsx)("input",{value:c.repeatPass,onChange:s,onBlur:d,type:"password",placeholder:"Repeat Password",name:"repeatPass",required:!0}),i.repeatPass&&l.repeatPass?Object(h.jsx)("div",{children:l.repeatPass}):null,Object(h.jsx)("hr",{}),Object(h.jsx)("input",{type:"submit",className:"registerbtn",value:"Register"})]}),Object(h.jsx)("div",{className:"signin",children:Object(h.jsxs)("p",{children:["Already have an account?",Object(h.jsx)(u.b,{to:"/login",children:"Sign in"}),"."]})})]})})},y=r(14);var w=function(e){var t=e.brand,r=e.model,n=e.year,a=e.price,s=e.imageUrl,c=e._id;return Object(h.jsxs)("div",{className:"listing",children:[Object(h.jsx)("div",{className:"preview",children:Object(h.jsx)("img",{src:s})}),Object(h.jsxs)("h2",{children:[t," ",r]}),Object(h.jsxs)("div",{className:"info",children:[Object(h.jsxs)("div",{className:"data-info",children:[Object(h.jsxs)("h3",{children:["Year: ",n]}),Object(h.jsxs)("h3",{children:["Price: ",a," $"]})]}),Object(h.jsx)("div",{className:"data-buttons",children:Object(h.jsx)(u.b,{to:"/details/".concat(c),className:"button-carDetails",children:"Details"})})]})]})};var C=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),r=t[0],a=t[1];return Object(n.useEffect)((function(){return fetch("https://cars-react-app-server.herokuapp.com/data/cars?sortBy=_createdOn%20desc").then((function(e){return e.json()})).then((function(e){a(e)})).catch((function(e){return alert(e.message)}))}),[]),r.length?Object(h.jsxs)("section",{id:"car-listings",children:[Object(h.jsx)("h1",{children:"Car Listings"}),Object(h.jsx)("div",{className:"listings",children:r.map((function(e,t){return Object(h.jsx)(w,Object(y.a)({},e),t)}))})]}):Object(h.jsx)("p",{className:"no-cars",children:"No cars in database."})},k=r(39);var N=function(e){var t=e.history,r=Object(n.useContext)(b).user,a=Object(n.useState)({brand:"",model:"",description:"",year:"",imageUrl:"",price:""}),s=Object(d.a)(a,2),c=s[0],i=s[1],l=function(){var e=Object(j.a)(o.a.mark((function e(n){var a,s,i,l,j,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),a=c.brand,s=c.model,i=c.description,l=c.year,j=c.imageUrl,u=c.price,e.prev=2,!(Number(l)<0||Number(u)<0)){e.next=5;break}throw new Error("Year and price must be positive numbers!");case 5:if(a&&s&&i&&l&&j&&u){e.next=7;break}throw new Error("All fields must be filled!");case 7:return e.next=9,fetch("https://cars-react-app-server.herokuapp.com/data/cars",{method:"POST",headers:{"Content-Type":"application/json","X-Authorization":r.authToken},body:JSON.stringify({brand:a,model:s,description:i,year:l,imageUrl:j,price:u})});case 9:if((d=e.sent).ok){e.next=16;break}return e.t0=Error,e.next=14,d.json();case 14:throw e.t1=e.sent.message,new e.t0(e.t1);case 16:t.push("/all-listings"),e.next=22;break;case 19:e.prev=19,e.t2=e.catch(2),alert(e.t2.message);case 22:case"end":return e.stop()}}),e,null,[[2,19]])})));return function(t){return e.apply(this,arguments)}}(),u=function(e){i(Object(y.a)(Object(y.a)({},c),{},Object(k.a)({},e.target.name,e.target.value)))};return Object(h.jsx)("section",{id:"create-listing",children:Object(h.jsx)("div",{className:"container",children:Object(h.jsxs)("form",{onSubmit:l,id:"create-form",children:[Object(h.jsx)("h1",{children:"Create Car Listing"}),Object(h.jsx)("p",{children:"Please fill in this form to create a listing."}),Object(h.jsx)("hr",{}),Object(h.jsx)("p",{children:"Car Brand"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter Car Brand",name:"brand",onChange:u,value:c.brand}),Object(h.jsx)("p",{children:"Car Model"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter Car Model",name:"model",onChange:u,value:c.model}),Object(h.jsx)("p",{children:"Description"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter Description",name:"description",onChange:u,value:c.description}),Object(h.jsx)("p",{children:"Car Year"}),Object(h.jsx)("input",{type:"number",placeholder:"Enter Car Year",name:"year",onChange:u,value:c.year}),Object(h.jsx)("p",{children:"Car Image"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter Car Image",name:"imageUrl",onChange:u,value:c.imageUrl}),Object(h.jsx)("p",{children:"Car Price"}),Object(h.jsx)("input",{type:"number",placeholder:"Enter Car Price",name:"price",onChange:u,value:c.price}),Object(h.jsx)("hr",{}),Object(h.jsx)("input",{type:"submit",className:"registerbtn",value:"Create Listing"})]})})})};var E=function(e){var t=e.match,r=e.history,a=Object(n.useState)({}),s=Object(d.a)(a,2),c=s[0],i=s[1],l=Object(n.useContext)(b).user,p="https://cars-react-app-server.herokuapp.com/data/cars/".concat(t.params.id);Object(n.useEffect)((function(){return fetch(p).then((function(e){return e.json()})).then((function(e){i(e)})).catch((function(e){return alert(e.message)}))}),[t.params.id]);var m=function(){var e=Object(j.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Please confirm to delete")){e.next=4;break}return e.next=3,fetch(p,{method:"DELETE",headers:{"X-Authorization":l.authToken}});case 3:r.push("/all-listings");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.jsxs)("section",{id:"listing-details",children:[Object(h.jsx)("h1",{children:"Details"}),Object(h.jsxs)("div",{className:"details-info",children:[Object(h.jsx)("img",{src:c.imageUrl}),Object(h.jsx)("hr",{}),Object(h.jsxs)("ul",{className:"listing-props",children:[Object(h.jsxs)("li",{children:[Object(h.jsx)("span",{children:"Brand:"}),c.brand]}),Object(h.jsxs)("li",{children:[Object(h.jsx)("span",{children:"Model:"}),c.model]}),Object(h.jsxs)("li",{children:[Object(h.jsx)("span",{children:"Year:"}),c.year]}),Object(h.jsxs)("li",{children:[Object(h.jsx)("span",{children:"Price:"}),c.price,"$"]})]}),Object(h.jsx)("p",{className:"description-para",children:c.description}),l.userId===c._ownerId&&Object(h.jsxs)("div",{className:"listings-buttons",children:[Object(h.jsx)(u.b,{to:"/edit/".concat(t.params.id),className:"button-list",children:"Edit"}),Object(h.jsx)("a",{onClick:m,className:"button-list",children:"Delete"})]})]})]})};var P=function(e){var t=e.match,r=e.history,a=Object(n.useState)([]),s=Object(d.a)(a,2),c=s[0],i=s[1],l=Object(n.useContext)(b).user,u="https://cars-react-app-server.herokuapp.com/data/cars/".concat(t.params.id);Object(n.useEffect)((function(){return fetch(u).then((function(e){return e.json()})).then((function(e){i(e)})).catch((function(e){return alert(e.message)}))}),[t.params.id]);var p=function(){var e=Object(j.a)(o.a.mark((function e(n){var a,s,c,i,j,d,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),a=n.target,s=a.brand,c=a.model,i=a.description,j=a.year,d=a.imageUrl,h=a.price,e.prev=2,!(Number(j)<0||Number(h)<0)){e.next=5;break}throw new Error("Year and price must be positive numbers!");case 5:if(s&&c&&i&&j&&d&&h){e.next=7;break}throw new Error("All fields must be filled!");case 7:return e.next=9,fetch(u,{method:"PUT",headers:{"Content-Type":"application/json","X-Authorization":l.authToken},body:JSON.stringify({brand:s.value,model:c.value,description:i.value,year:j.value,imageUrl:d.value,price:h.value})});case 9:e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(2),e.abrupt("return",alert(e.t0.message));case 14:return e.abrupt("return",r.push("/details/".concat(t.params.id)));case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)("section",{id:"edit-listing",children:Object(h.jsx)("div",{className:"container",children:Object(h.jsxs)("form",{onSubmit:p,id:"edit-form",children:[Object(h.jsx)("h1",{children:"Edit Car Listing"}),Object(h.jsx)("p",{children:"Please fill in this form to edit an listing."}),Object(h.jsx)("hr",{}),Object(h.jsx)("p",{children:"Car Brand"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter Car Brand",name:"brand",defaultValue:c.brand}),Object(h.jsx)("p",{children:"Car Model"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter Car Model",name:"model",defaultValue:c.model}),Object(h.jsx)("p",{children:"Description"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter Description",name:"description",defaultValue:c.description}),Object(h.jsx)("p",{children:"Car Year"}),Object(h.jsx)("input",{type:"number",placeholder:"Enter Car Year",name:"year",defaultValue:c.year}),Object(h.jsx)("p",{children:"Car Image"}),Object(h.jsx)("input",{type:"text",placeholder:"Enter Car Image",name:"imageUrl",defaultValue:c.imageUrl}),Object(h.jsx)("p",{children:"Car Price"}),Object(h.jsx)("input",{type:"number",placeholder:"Enter Car Price",name:"price",defaultValue:c.price}),Object(h.jsx)("hr",{}),Object(h.jsx)("input",{type:"submit",class:"registerbtn",value:"Edit Listing"})]})})})};var S=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),r=t[0],a=t[1],s=Object(n.useContext)(b).user;return Object(n.useEffect)((function(){return fetch("https://cars-react-app-server.herokuapp.com/data/cars?where=_ownerId%3D%22".concat(s.userId,"%22&sortBy=_createdOn%20desc")).then((function(e){return e.json()})).then((function(e){a(e)})).catch((function(e){return alert(e.message)}))}),[s.userId]),r.length?Object(h.jsxs)("section",{id:"my-listings",children:[Object(h.jsx)("h1",{children:"My car listings"}),Object(h.jsx)("div",{className:"listings",children:r.map((function(e,t){return Object(h.jsx)(w,Object(y.a)({},e),t)}))})]}):Object(h.jsx)("p",{className:"no-cars",children:" You haven't listed any cars yet."})};var T=function(){return Object(h.jsx)("footer",{children:Object(h.jsx)("p",{children:"\xa9 All rights reserved"})})};var I=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),r=t[0],a=t[1],s=Object(n.useRef)("");return Object(h.jsxs)("section",{id:"search-cars",children:[Object(h.jsx)("h1",{children:"Filter by year"}),Object(h.jsxs)("div",{className:"container",children:[Object(h.jsx)("input",{id:"search-input",type:"text",name:"search",placeholder:"Enter desired production year",ref:s}),Object(h.jsx)("button",{onClick:function(){var e=Number(s.current.value);!1===Number.isNaN(e)&&Number(e)>0?fetch("https://cars-react-app-server.herokuapp.com/data/cars?where=year%3D".concat(e)).then((function(e){return e.json()})).then((function(e){a(e)})).catch((function(e){return e.message})):alert("Year must be a positive number!")},className:"button-list",children:"Search"})]}),Object(h.jsx)("h2",{children:"Results:"}),Object(h.jsx)("div",{className:"listings",children:0===r.length?Object(h.jsx)("p",{className:"no-cars",children:" No results."}):r.map((function(e){return Object(h.jsx)(w,Object(y.a)({},e),e._id)}))})]})};var U=function(){var e=Object(n.useContext)(b),t=e.user,r=e.setUser;return Object(n.useEffect)((function(){var e=JSON.parse(localStorage.getItem("user"))||{authToken:null,userId:null,email:null};r(e)}),[]),Object(n.useEffect)((function(){localStorage.setItem("user",JSON.stringify(t))}),[t]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(m,{}),Object(h.jsxs)(i.c,{children:[Object(h.jsx)(i.a,{exact:!0,path:"/",component:x}),Object(h.jsx)(i.a,{exact:!0,path:"/login",component:O}),Object(h.jsx)(i.a,{exact:!0,path:"/register",component:g}),Object(h.jsx)(i.a,{exact:!0,path:"/all-listings",component:C}),Object(h.jsx)(i.a,{exact:!0,path:"/create-car",component:N}),Object(h.jsx)(i.a,{exact:!0,path:"/details/:id",component:E}),Object(h.jsx)(i.a,{exact:!0,path:"/edit/:id",component:P}),Object(h.jsx)(i.a,{exact:!0,path:"/my-listings",component:S}),Object(h.jsx)(i.a,{exact:!0,path:"/by-year",component:I})]}),Object(h.jsx)(T,{})]})},D=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,194)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;r(e),n(e),a(e),s(e),c(e)}))};c.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(u.a,{children:Object(h.jsx)(p,{children:Object(h.jsx)(U,{})})})}),document.getElementById("root")),D()},87:function(e,t,r){},88:function(e,t,r){}},[[193,1,2]]]);
//# sourceMappingURL=main.4bb0495f.chunk.js.map